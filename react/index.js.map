{"version":3,"file":"index.js","sources":["../src/react/index.js"],"sourcesContent":["import React, { Component, Fragment } from 'react'\nimport { observe, computed, dispose } from 'hyperactiv'\n\nexport class Watch extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {}\n    }\n    componentWillUnmount() {\n        this.__unmounted = true\n        if(this.state.render) {\n            dispose(this.state.render)\n        }\n    }\n    componentDidMount() {\n        this.refreshWatcherInState()\n    }\n    componentDidUpdate(prevProps) {\n        if(prevProps.render !== this.props.render) {\n            dispose(prevProps.render)\n            this.refreshWatcherInState()\n        }\n    }\n    refreshWatcherInState() {\n        if(this.props.render) {\n            this.setState({\n                render: computed(this.props.render, {\n                    autoRun: false,\n                    callback: () => {\n                        !this.__unmounted &&\n                        this.forceUpdate.bind(this)()\n                    }\n                })\n            })\n        }\n    }\n    render() {\n        const { render } = this.state\n        return React.createElement(\n            Fragment,\n            [],\n            render && render()\n        )\n    }\n}\n\nexport const store = function(obj, options = {}) {\n    return observe(obj, { deep: true, batch: true, ...options })\n}"],"names":["Component","[object Object]","props","super","this","state","__unmounted","render","dispose","refreshWatcherInState","prevProps","setState","computed","autoRun","callback","forceUpdate","bind","React","createElement","Fragment","obj","options","observe","deep","batch"],"mappings":"iVAG2BA,YACvBC,YAAYC,GACRC,MAAMD,GACNE,KAAKC,SAETJ,uBACIG,KAAKE,aAAc,EAChBF,KAAKC,MAAME,QACVC,UAAQJ,KAAKC,MAAME,QAG3BN,oBACIG,KAAKK,wBAETR,mBAAmBS,GACZA,EAAUH,SAAWH,KAAKF,MAAMK,SAC/BC,UAAQE,EAAUH,QAClBH,KAAKK,yBAGbR,wBACOG,KAAKF,MAAMK,QACVH,KAAKO,UACDJ,OAAQK,WAASR,KAAKF,MAAMK,QACxBM,SAAS,EACTC,SAAU,MACLV,KAAKE,aACNF,KAAKW,YAAYC,KAAKZ,KAAtBA,QAMpBH,SACI,MAAMM,OAAEA,GAAWH,KAAKC,MACxB,OAAOY,EAAMC,cACTC,cAEAZ,GAAUA,eAKD,SAASa,EAAKC,MAC/B,OAAOC,UAAQF,GAAOG,MAAM,EAAMC,OAAO,KAASH"}