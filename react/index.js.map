{"version":3,"file":"index.js","sources":["../src/react/index.js"],"sourcesContent":["import React, { PureComponent, Fragment } from 'react'\nimport hyperactiv from 'hyperactiv'\n\nconst { observe, computed, dispose } = hyperactiv\n\nexport class Watch extends PureComponent {\n    constructor(props) {\n        super(props)\n        this.state = {}\n    }\n    componentWillUnmount() {\n        this.__mounted = false\n        if(this.state.render) {\n            dispose(this.state.render)\n        }\n    }\n    componentDidMount() {\n        this.__mounted = true\n        this.refreshWatcherInState()\n    }\n    componentDidUpdate(prevProps) {\n        if(prevProps.render !== this.props.render) {\n            dispose(prevProps.render)\n            this.refreshWatcherInState()\n        }\n    }\n    refreshWatcherInState() {\n        if(this.props.render) {\n            this.setState({\n                render: computed(this.props.render, {\n                    autoRun: false,\n                    callback: () => {\n                        this.__mounted &&\n                        this.forceUpdate.bind(this)()\n                    }\n                })\n            })\n        }\n    }\n    render() {\n        const { render } = this.state\n        return React.createElement(\n            Fragment,\n            [],\n            render && render()\n        )\n    }\n}\n\nexport const store = function(obj, options = {}) {\n    return observe(obj, Object.assign({ deep: true, batch: true }, options))\n}"],"names":["observe","computed","dispose","hyperactiv","PureComponent","[object Object]","props","super","this","state","__mounted","render","refreshWatcherInState","prevProps","setState","autoRun","callback","forceUpdate","bind","React","createElement","Fragment","obj","options","Object","assign","deep","batch"],"mappings":"wWAGA,MAAMA,QAAEA,EAAOC,SAAEA,EAAQC,QAAEA,GAAYC,wBAEZC,gBACvBC,YAAYC,GACRC,MAAMD,GACNE,KAAKC,SAETJ,uBACIG,KAAKE,WAAY,EACdF,KAAKC,MAAME,QACVT,EAAQM,KAAKC,MAAME,QAG3BN,oBACIG,KAAKE,WAAY,EACjBF,KAAKI,wBAETP,mBAAmBQ,GACZA,EAAUF,SAAWH,KAAKF,MAAMK,SAC/BT,EAAQW,EAAUF,QAClBH,KAAKI,yBAGbP,wBACOG,KAAKF,MAAMK,QACVH,KAAKM,UACDH,OAAQV,EAASO,KAAKF,MAAMK,QACxBI,SAAS,EACTC,SAAU,KACNR,KAAKE,WACLF,KAAKS,YAAYC,KAAKV,KAAtBA,QAMpBH,SACI,MAAMM,OAAEA,GAAWH,KAAKC,MACxB,OAAOU,EAAMC,cACTC,cAEAV,GAAUA,eAKD,SAASW,EAAKC,MAC/B,OAAOvB,EAAQsB,EAAKE,OAAOC,QAASC,MAAM,EAAMC,OAAO,GAAQJ"}